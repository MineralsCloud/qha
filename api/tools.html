<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1.10. Some miscellaneous functions &#8212; qha 1.0.10 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.11. Equation of states" href="eos.html" />
    <link rel="prev" title="1.9. Thermodynamic properties" href="thermodynamics.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          qha</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.10</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">1. API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">2. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/index.html">3. Development</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">1.10. Some miscellaneous functions</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="thermodynamics.html" title="Previous Chapter: 1.9. Thermodynamic properties"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 1.9. Thermody...</span>
    </a>
  </li>
  <li>
    <a href="eos.html" title="Next Chapter: 1.11. Equation of states"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">1.11. Equatio... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/api/tools.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="some-miscellaneous-functions">
<h1>1.10. Some miscellaneous functions<a class="headerlink" href="#some-miscellaneous-functions" title="Permalink to this headline">¶</a></h1>
<p>This module contains some misceallenous functions used in the program.</p>
<span class="target" id="module-qha"></span><span class="target" id="module-qha.tools"></span><dl class="attribute">
<dt id="qha.tools.find_nearest">
<code class="descclassname">qha.tools.</code><code class="descname">find_nearest</code><span class="sig-paren">(</span><em>array</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qha/tools.html#find_nearest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qha.tools.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an <em>array</em> , and given a <em>value</em> , returns an index <code class="docutils literal notranslate"><span class="pre">j</span></code> such that <em>value</em> is between <code class="docutils literal notranslate"><span class="pre">array[j]</span></code>
and <code class="docutils literal notranslate"><span class="pre">array[j+1]</span></code>. The <em>array</em> must be monotonic increasing. <code class="docutils literal notranslate"><span class="pre">j=-1</span></code> or <code class="docutils literal notranslate"><span class="pre">j=len(array)</span></code> is returned
to indicate that <em>value</em> is out of range below and above respectively.
If <em>array</em> is unsorted, consider first using an <span class="math notranslate nohighlight">\(O(n \log n)\)</span> sort and then use this function.
Referenced from <a class="reference external" href="https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array">here</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array</em><em>(</em><em>float64</em><em>, </em><em>1d</em><em>, </em><em>A</em><em>)</em>) – An array of monotonic increasing reals filled.</li>
<li><strong>value</strong> (<em>float64</em>) – The value which you want to find between two of the consecutive elements in <em>array</em>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The index, see above.</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_nearest</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_nearest</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_nearest</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="mi">12</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="qha.tools.lagrange3">
<code class="descclassname">qha.tools.</code><code class="descname">lagrange3</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qha/tools.html#lagrange3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qha.tools.lagrange3" title="Permalink to this definition">¶</a></dt>
<dd><p>Third-order Lagrange interpolation, referenced from
<a class="reference external" href="http://mathworld.wolfram.com/LagrangeInterpolatingPolynomial.html">here</a>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">lagrange3</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
<span class="go">5.125</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xs</strong> (<em>array</em><em>(</em><em>float64</em><em>, </em><em>1d</em><em>, </em><em>A</em><em>)</em>) – </li>
<li><strong>ys</strong> (<em>array</em><em>(</em><em>float64</em><em>, </em><em>1d</em><em>, </em><em>A</em><em>)</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.6)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="qha.tools.lagrange4">
<code class="descclassname">qha.tools.</code><code class="descname">lagrange4</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qha/tools.html#lagrange4"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qha.tools.lagrange4" title="Permalink to this definition">¶</a></dt>
<dd><p>Fourth-order Lagrange interpolation, referenced from
<a class="reference external" href="http://mathworld.wolfram.com/LagrangeInterpolatingPolynomial.html">here</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xs</strong> (<em>array</em><em>(</em><em>float64</em><em>, </em><em>1d</em><em>, </em><em>A</em><em>)</em>) – </li>
<li><strong>ys</strong> (<em>array</em><em>(</em><em>float64</em><em>, </em><em>1d</em><em>, </em><em>A</em><em>)</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.6)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="qha.tools.is_monotonic_decreasing">
<code class="descclassname">qha.tools.</code><code class="descname">is_monotonic_decreasing</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qha/tools.html#is_monotonic_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qha.tools.is_monotonic_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the <em>array</em> is monotonic decreasing or not.
For example, in QHA calculation, the volumes should be listed as decreasing array,
and the pressures should be monotonic increasing.
This function can be used to check whether the volumes are in the right order.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">is_monotonic_decreasing</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_monotonic_decreasing</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array</strong> (<em>array</em><em>(</em><em>float64</em><em>, </em><em>1d</em><em>, </em><em>A</em><em>)</em>) – The array to be evaluated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">True</span></code> if <em>array</em> is monotonic decreasing, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="qha.tools.is_monotonic_increasing">
<code class="descclassname">qha.tools.</code><code class="descname">is_monotonic_increasing</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qha/tools.html#is_monotonic_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qha.tools.is_monotonic_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the <em>array</em> is monotonic increasing or not.
For example, in QHA calculation, the volumes should be listed as decreasing array,
and the pressures should be monotonic increasing.
This function can be used to check whether the pressures are in the right order.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">is_monotonic_increasing</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_monotonic_increasing</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array</strong> (<em>array</em><em>(</em><em>float64</em><em>, </em><em>1d</em><em>, </em><em>A</em><em>)</em>) – The array to be evaluated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">True</span></code> if <em>array</em> is monotonic increasing, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="qha.tools.arange">
<code class="descclassname">qha.tools.</code><code class="descname">arange</code><span class="sig-paren">(</span><em>start</em>, <em>num</em>, <em>step</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qha/tools.html#arange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qha.tools.arange" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <code class="docutils literal notranslate"><span class="pre">numpy.arange</span></code>, generate an one-dimensional array but with <em>start</em>, <em>num</em>, <em>step</em> specified.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<em>float64</em>) – The starting point of the array, which is included in this array.</li>
<li><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – The total number of elements in this array.</li>
<li><strong>step</strong> (<em>float64</em>) – The difference between any of the two elements.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">array(float64, 1d, A)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An arithmetic progression.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="qha.tools.calibrate_energy_on_reference">
<code class="descclassname">qha.tools.</code><code class="descname">calibrate_energy_on_reference</code><span class="sig-paren">(</span><em>volumes_before_calibration</em>, <em>energies_before_calibration</em>, <em>order=3</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qha/tools.html#calibrate_energy_on_reference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qha.tools.calibrate_energy_on_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>In multi-configuration system calculation, volume set of each calculation may varies a little,
This function would make the volume set  of configuration 1 (normally, the most populated configuration)
as a reference volume set, then calibrate the energies of all configurations to this reference volume set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>volumes_before_calibration</strong> (<em>array</em><em>(</em><em>float64</em><em>, </em><em>2d</em><em>, </em><em>A</em><em>)</em>) – Original volume sets of all configurations</li>
<li><strong>energies_before_calibration</strong> (<em>array</em><em>(</em><em>float64</em><em>, </em><em>2d</em><em>, </em><em>A</em><em>)</em>) – Free energies of all configurations on the corresponding volume sets.</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – The order of Birch–Murnaghan EOS fitting.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Free energies of each configuration on referenced volumes (usually the volumes of the first configuration).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Tian Qin, Qi Zhang.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>